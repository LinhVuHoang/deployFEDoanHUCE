{"version":3,"sources":["webpack:///./src/service/TKBHocKyService.js","webpack:///./src/views/QuanLyDHP.vue?1445","webpack:///./src/service/QuanLyDiemHPService.js","webpack:///src/views/QuanLyDHP.vue","webpack:///./src/views/QuanLyDHP.vue?7400","webpack:///./src/views/QuanLyDHP.vue"],"names":["URL_TKB","URL_DotHK","URL_DSSV","URL_LichThi","URL_LichDay","URL_Nganh","TKBHocKyService","getTKBHocKy","params","http","get","getTKBLichThi","getDotHocKy","getdssv","MaLopHocPhan","MaLopHoc","TenDot","getTKBGiangDay","getNganh","render","_vm","this","_h","$createElement","_c","_self","attrs","staticStyle","staticClass","on","handleSearch","model","value","callback","$$v","$set","expression","datahk","_l","item","index","key","_v","_s","resetButton","data","length","exportToExcel","_e","columns","scopedSlots","_u","fn","text","record","IDLopHocPhan","$event","updateStatus","split","MaMonHoc","LopDuKien","page","limit","totalRecords","onShowSizeChange","onChange","staticRenderFns","URL_GetAll","URL_GetDS","QuanLyDiemHPService","getAll","Update","status","put","getDS","title","dataIndex","customRender","authorsHeaderBtns","data1","undefined","totalPages","TenPhong","new_data","search","hocky","orderby","params1","isChecked","IDDot","created","localStorage","setItem","$route","fullPath","getTKBDotHK","methods","then","rs","result","recordset","console","log","e","records","i","filtered","current","pageSize","getQuanLyDHP","preventDefault","GetQuanLyDHP1","filter","IsDaNopBanGiay","MGV","Array","from","Set","TGV","j","idlophocphan","$confirm","onOk","onCancel","document","getElementById","checked","workbook","ExcelJS","Workbook","worksheet","addWorksheet","studentData","OrderProperties","customizeData","titleStyle","font","size","bold","alignment","horizontal","mergeCells","getCell","style","wrapText","border","top","color","argb","left","bottom","right","studentArray","Object","values","push","forEach","row","excelRow","addRow","column","blob","xlsx","writeBuffer","blobURL","URL","createObjectURL","Blob","type","a","createElement","href","download","display","body","appendChild","click","removeChild","map","dssv","DaKhoaDiemKetThuc","DaKhoaDiemQuaTrinh","Email","TenHeDaoTao","IDLopXepLichThi","Id","MaGiangVien","TenGiangVien","IsKhoaTH","IsKhoaTL","IsXacNhan","NgayCapNhat","NgayNopBanGiay","NgayTao","NguoiCapNhat","NguoiTao","Nhom","SoDienThoai","TenNganh","TenNghe","rest","newOrder","newData","assign","component"],"mappings":"kHAAA,gBACA,MAAMA,EAAU,YACVC,EAAY,UACZC,EAAW,kBACXC,EAAc,cACdC,EAAc,eACdC,EAAY,QAClB,MAAMC,EACFC,YAAYC,GACR,OAAOC,OAAKC,IAAIV,EAAQ,CACpBQ,OAAOA,IAGfG,cAAcH,GACV,OAAOC,OAAKC,IAAIP,EAAY,CACxBK,OAAOA,IAGfI,cACI,OAAOH,OAAKC,IAAIT,GAEpBY,QAAQC,EAAaC,EAASC,GAC1B,OAAOP,OAAKC,IAAIR,EAAS,IAAIY,EAAa,IAAIC,EAAS,IAAIC,GAE/DC,eAAeT,GACX,OAAOC,OAAKC,IAAIN,EAAY,CACxBI,OAAOA,IAGfU,WACI,OAAOT,OAAKC,IAAIL,IAGT,WAAIC,G,yCCjCnB,IAAIa,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,SAAS,CAACA,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,OAAO,MAAQ,WAAW,CAACF,EAAG,MAAM,CAACG,YAAY,CAAC,MAAQ,QAAQD,MAAM,CAAC,IAAM,wBAAwB,IAAM,cAAcF,EAAG,MAAM,CAACA,EAAG,SAAS,CAACI,YAAY,uBAAuBC,GAAG,CAAC,OAAST,EAAIU,eAAe,CAACN,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,YAAY,CAAC,gBAAgB,QAAQD,MAAM,CAAC,KAAO,KAAK,CAACF,EAAG,cAAc,CAACA,EAAG,iBAAiB,CAACE,MAAM,CAAC,YAAc,kBAAkBK,MAAM,CAACC,MAAOZ,EAAIZ,OAAa,OAAEyB,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIZ,OAAQ,SAAU0B,IAAME,WAAW,kBAAkB,CAACZ,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,aAAa,IAAI,IAAI,GAAGF,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,KAAK,CAACF,EAAG,cAAc,CAACA,EAAG,WAAW,CAACE,MAAM,CAAC,YAAcN,EAAIiB,OAAO,GAAGrB,QAAQe,MAAM,CAACC,MAAOZ,EAAIZ,OAAY,MAAEyB,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIZ,OAAQ,QAAS0B,IAAME,WAAW,iBAAiBhB,EAAIkB,GAAIlB,EAAU,QAAE,SAASmB,EAAKC,GAAO,OAAOhB,EAAG,kBAAkB,CAACiB,IAAID,EAAMd,MAAM,CAAC,MAAQa,EAAKvB,SAAS,CAACI,EAAIsB,GAAGtB,EAAIuB,GAAGJ,EAAKvB,cAAa,IAAI,IAAI,IAAI,IAAI,GAAGQ,EAAG,WAAW,CAACE,MAAM,CAAC,KAAO,UAAU,YAAY,UAAUG,GAAG,CAAC,MAAQT,EAAIU,eAAe,CAACV,EAAIsB,GAAG,cAAclB,EAAG,WAAW,CAACG,YAAY,CAAC,cAAc,QAAQD,MAAM,CAAC,KAAO,UAAU,YAAY,UAAUG,GAAG,CAAC,MAAQT,EAAIwB,cAAc,CAACxB,EAAIsB,GAAG,aAActB,EAAIyB,KAAKC,OAAO,EAAGtB,EAAG,SAAS,CAACI,YAAY,eAAeD,YAAY,CAAC,MAAQ,SAASD,MAAM,CAAC,KAAO,UAAUG,GAAG,CAAC,MAAQT,EAAI2B,gBAAgB,CAACvB,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,aAAa,MAAQ,aAAa,GAAGN,EAAI4B,MAAM,GAAGxB,EAAG,UAAU,CAACE,MAAM,CAAC,QAAUN,EAAI6B,QAAQ,cAAc7B,EAAIyB,KAAK,YAAa,GAAOK,YAAY9B,EAAI+B,GAAG,CAAC,CAACV,IAAI,qBAAqBW,GAAG,SAASC,GAAM,MAAO,CAAQ7B,EAAG,MAAM,CAACI,YAAY,eAA7B,EAA4C,CAACJ,EAAG,IAAI,CAACI,YAAY,mBAAmBD,YAAY,CAAC,MAAQ,UAAU,CAACP,EAAIsB,GAAG,cAAoD,CAAClB,EAAG,IAAI,CAACI,YAAY,mBAAmBD,YAAY,CAAC,MAAQ,eAAe,CAACP,EAAIsB,GAAG,oBAAoB,CAACD,IAAI,oBAAoBW,GAAG,SAASC,GAAM,MAAO,CAAQ7B,EAAG,MAAM,CAACI,YAAY,eAA7B,EAA4C,CAACJ,EAAG,IAAI,CAACI,YAAY,mBAAmBD,YAAY,CAAC,MAAQ,UAAU,CAACP,EAAIsB,GAAG,cAAoD,CAAClB,EAAG,IAAI,CAACI,YAAY,mBAAmBD,YAAY,CAAC,MAAQ,eAAe,CAACP,EAAIsB,GAAG,oBAAoB,CAACD,IAAI,iBAAiBW,GAAG,SAASC,EAAKC,GAAQ,MAAO,CAAQ,GAAND,EAAS7B,EAAG,MAAM,CAACI,YAAY,eAAe,CAACJ,EAAG,IAAI,CAACI,YAAY,mBAAmBD,YAAY,CAAC,MAAQ,UAAU,CAACP,EAAIsB,GAAG,cAAclB,EAAG,MAAM,CAACI,YAAY,cAAcD,YAAY,CAAC,cAAc,WAAW,CAACH,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,WAAW,GAAK,gBAAkB4B,EAAOC,cAAc1B,GAAG,CAAC,OAAS,SAAS2B,GAAQ,OAAOpC,EAAIqC,aAAaH,EAAOC,aAAa,YAAY,CAACd,IAAI,UAAUW,GAAG,SAASC,GAAM,MAAO,CAAC7B,EAAG,MAAM,CAACI,YAAY,eAAe,CAACJ,EAAG,IAAI,CAACI,YAAY,oBAAoB,CAACR,EAAIsB,GAAGtB,EAAIuB,GAAGU,EAAKK,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAG,IAAIL,EAAKK,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAG,IAAIL,EAAKK,MAAM,KAAK,GAAGA,MAAM,KAAK,YAAY,CAACjB,IAAI,iBAAiBW,GAAG,SAASC,GAAM,MAAO,CAAC7B,EAAG,MAAM,CAACI,YAAY,eAAe,CAACJ,EAAG,IAAI,CAACI,YAAY,oBAAoB,CAACR,EAAIsB,GAAGtB,EAAIuB,GAAGU,EAAKK,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAG,IAAIL,EAAKK,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAG,IAAIL,EAAKK,MAAM,KAAK,GAAGA,MAAM,KAAK,YAAY,CAACjB,IAAI,UAAUW,GAAG,SAASC,GAAM,MAAO,CAAC7B,EAAG,MAAM,CAACA,EAAG,IAAI,CAACI,YAAY,SAASF,MAAM,CAAC,KAAO,kBAAmB2B,EAAKM,SAAS,IAAIN,EAAKO,UAAU,IAAIP,EAAKrC,SAAS,CAACQ,EAAG,SAAS,CAACG,YAAY,CAAC,YAAY,OAAO,MAAQ,WAAWD,MAAM,CAAC,KAAO,kBAAkB,YAAYF,EAAG,MAAM,CAACG,YAAY,CAAC,cAAc,OAAO,eAAe,SAAS,CAACH,EAAG,eAAe,CAACE,MAAM,CAAC,QAAUL,KAAKb,OAAOqD,KAAK,kBAAkBxC,KAAKb,OAAOsD,MAAM,MAAQzC,KAAK0C,aAAa,oBAAoB,IAAIlC,GAAG,CAAC,eAAiBT,EAAI4C,iBAAiB,OAAS5C,EAAI6C,aAAa,IAAI,IAAI,IACzvHC,EAAkB,G,YCAtB,MAAMC,EAAa,QACbC,EAAW,QACjB,MAAMC,EACFC,OAAO9D,GACH,OAAOC,OAAKC,IAAIyD,EAAW,CACvB3D,OAAOA,IAGf+D,OAAOhB,EAAaiB,GAChB,OAAO/D,OAAKgE,IAAIN,EAAW,IAAIZ,EAAa,IAAIiB,GAEpDE,MAAMlE,GACF,OAAOC,OAAKC,IAAI0D,EAAU,CACtB5D,OAAOA,KAIJ,UAAI6D,E,iCC2FnB,MAAApB,EAAA,CACA,CACA0B,MAAA,aACAC,UAAA,WACA1B,YAAA,CAAA2B,aAAA,aAEA,CACAF,MAAA,cACAC,UAAA,YACA1B,YAAA,CAAA2B,aAAA,cAEA,CACAF,MAAA,MACAC,UAAA,WACA1B,YAAA,CAAA2B,aAAA,aAEA,CACAF,MAAA,eACAC,UAAA,WACA1B,YAAA,CAAA2B,aAAA,aAEA,CACAF,MAAA,aACAC,UAAA,eACA1B,YAAA,CAAA2B,aAAA,iBAEA,CACAF,MAAA,WACAC,UAAA,UACA1B,YAAA,CAAA2B,aAAA,YAEA,CACAF,MAAA,WACAC,UAAA,qBACA1B,YAAA,CAAA2B,aAAA,uBAEA,CACAF,MAAA,eACAC,UAAA,oBACA1B,YAAA,CAAA2B,aAAA,sBAEA,CACAF,MAAA,kBACAC,UAAA,iBACA1B,YAAA,CAAA2B,aAAA,mBAEA,CACAF,MAAA,oBACAC,UAAA,iBACA1B,YAAA,CAAA2B,aAAA,oBAOe,OACfhC,OACA,OAEAiC,kBAAA,MACAjC,KAAA,GACAkC,MAAA,GACA9B,UACAc,kBAAAiB,EACAC,gBAAAD,EACAE,cAAAF,EACAG,SAAA,GACA3E,OAAA,CACAqD,KAAA,EACAC,MAAA,GACAsB,YAAAJ,EACAK,WAAAL,EACAM,QAAA,YAEAC,QAAA,CACA1B,KAAA,EACAC,MAAA,IACAsB,YAAAJ,EACAK,WAAAL,EACAM,QAAA,YAEAE,WAAA,EACAC,WAAAT,EACA3C,OAAA,KAGAqD,UACAC,aAAAC,QAAA,YAAAC,OAAAC,UACA,KAAAC,eAEAC,QAAA,CACA,0BACA1F,OAAAM,cAAAqF,KACAC,IACA,IACA,KAAA7D,OAAA6D,EAAArD,KAAAsD,OAAAC,UACAC,QAAAC,IAAA,KAAAjE,QACA,MAAAkE,GACAF,QAAAC,IAAAC,GACAF,QAAAC,IAAA,2BAKA,2BACAjC,EAAAC,OAAA,KAAA9D,QAAAyF,KACAC,IACA,IAGA,GAFA,KAAArD,KAAA,GACAwD,QAAAC,IAAAJ,QACAlB,GAAAkB,EAAArD,KAAA2D,QAAA,CACA,KAAA3D,KAAAqD,EAAArD,KAAA2D,QACA,QAAAC,EAAA,EAAAA,EAAA,KAAA5D,KAAAC,OAAA2D,IACA,KAAA5D,KAAA4D,GAAA,cACA,KAAA5D,KAAA4D,GAAA,OAAAA,EAAA,OAGA,KAAA5D,KAAA,GAEAwD,QAAAC,IAAA,KAAAzD,MACAqD,EAAArD,KAAA6D,SAAA,EACA,KAAA3C,aAAAmC,EAAArD,KAAA6D,SAEA,KAAA3C,aAAA,EAEAsC,QAAAC,IAAA,KAAAzD,MACA,MAAA0D,GACAF,QAAAC,IAAAC,GACAF,QAAAC,IAAA,UACA,KAAAvC,aAAA,MAKAC,iBAAA2C,EAAAC,GACA,KAAApG,OAAAsD,MAAA8C,EACA,KAAApG,OAAAqD,KAAA8C,EACA,KAAAE,gBAEA5C,SAAAJ,EAAA+C,GACA,KAAApG,OAAAqD,OACA,KAAArD,OAAAsD,MAAA8C,EACA,KAAAC,gBAEA/E,aAAAyE,GACAA,EAAAO,iBACA,KAAAtG,OAAAqD,KAAA,OACAmB,GAAA,KAAAxE,OAAA6E,QACAgB,QAAAC,IAAA,KAAAjE,OAAA,GAAArB,QACA,KAAAR,OAAA6E,MAAA,KAAAhD,OAAA,GAAArB,OACAqF,QAAAC,IAAA,KAAA9F,OAAA6E,QAEA,KAAAwB,eACA,KAAAE,gBACAV,QAAAC,IAAA,KAAA9F,SAGA,sBACA,KAAA+E,QAAAH,OAAA,KAAA5E,OAAA4E,OACA,KAAAG,QAAAF,MAAA,KAAA7E,OAAA6E,YACAhB,EAAAC,OAAA,KAAAiB,SAAAU,KACAC,IACA,IAGA,GAFA,KAAAnB,MAAA,GACAsB,QAAAC,IAAAJ,QACAlB,GAAAkB,EAAArD,KAAA2D,QAAA,CACA,KAAAzB,MAAAmB,EAAArD,KAAA2D,QAAAQ,OAAAzE,GACA,OAAAA,EAAA0E,iBACA,IAAA1E,EAAA0E,gBACA,IAAA1E,EAAA0E,gBAEA,QAAAR,EAAA,EAAAA,EAAA,KAAA1B,MAAAjC,OAAA2D,IAAA,CACA,KAAA1B,MAAA0B,GAAA,OAAAA,EAAA,EACA,MAAApD,EAAA,KAAA0B,MAAA0B,GAAA,WACA,KAAA1B,MAAA0B,GAAA,WAAApD,EAAAK,MAAA,QAAAA,MAAA,YAAAL,EAAAK,MAAA,QAAAA,MAAA,YAAAL,EAAAK,MAAA,QAAAA,MAAA,QACA,MAAAwD,EAAAC,MAAAC,KAAA,IAAAC,IAAA,KAAAtC,MAAA0B,GAAA,eAAA/C,MAAA,QACA4D,EAAAH,MAAAC,KAAA,IAAAC,IAAA,KAAAtC,MAAA0B,GAAA,gBAAA/C,MAAA,QACA2C,QAAAC,IAAAY,GACAb,QAAAC,IAAAgB,GACA,KAAAvC,MAAA0B,GAAA,gBACA,QAAAc,EAAA,EAAAA,EAAAL,EAAApE,OAAAyE,IACA,KAAAxC,MAAA0B,GAAA,cAAAS,EAAAK,GAAA,IAAAD,EAAAC,GACAA,GAAAL,EAAApE,OAAA,IACA,KAAAiC,MAAA0B,GAAA,0BAKA,KAAA1B,MAAA,GAEAsB,QAAAC,IAAA,KAAAvB,OACA,MAAAwB,GACAF,QAAAC,IAAAC,GACAF,QAAAC,IAAA,cAKA7C,aAAA+D,EAAAhD,GAEA,GAAAA,IACA6B,QAAAC,IAAAkB,GACA,KAAAC,SAAA,CACA9C,MAAA,2BACA+C,UACArD,EAAAE,OAAAiD,EAAA,KAAAvB,KACAC,IACA,QAAAO,EAAA,EAAAA,EAAA,KAAA5D,KAAAC,OAAA2D,IACA,KAAA5D,KAAA4D,GAAA,iBAAAe,IACA,KAAA3E,KAAA4D,GAAA,eAGAJ,QAAAC,IAAAJ,EAAArD,MACA,KAAAgE,eACA,KAAAE,mBAIAY,cAEAtD,EAAAE,OAAAiD,EAAA,KAAAvB,KACAC,IACAG,QAAAC,IAAAJ,EAAArD,MACA+E,SAAAC,eAAA,gBAAAL,GAAAM,SAAA,EACA,QAAArB,EAAA,EAAAA,EAAA,KAAA5D,KAAAC,OAAA2D,IACA,KAAA5D,KAAA4D,GAAA,iBAAAe,IACA,KAAA3E,KAAA4D,GAAA,cACAJ,QAAAC,IAAA,KAAAzD,KAAA4D,GAAA,aAGA,KAAAjB,WAAA,EAEA,KAAAqB,eACA,KAAAE,uBAOAnE,cACA,KAAApC,OAAA,CACAqD,KAAA,EACAC,MAAA,GACAsB,OAAA,GACAC,MAAA,KAAAhD,OAAA,GAAArB,OACAsE,QAAA,YAEA,KAAAuB,eACA,KAAAE,iBAEA,sBACA,MAAAgB,EAAA,IAAAC,IAAAC,SACAC,EAAAH,EAAAI,aAAA,wCACAC,EAAA,KAAAC,gBAAA,KAAAC,cAAA,KAAAvD,QACAsB,QAAAC,IAAA8B,GAEA,MAAAvF,EAAA,GAGA0F,EAAA,CACAC,KAAA,CACAC,KAAA,GACAC,MAAA,GAEAC,UAAA,CACAC,WAAA,WAMAV,EAAAW,WAAA,SACAX,EAAAY,QAAA,MAAA9G,MAAA,uCACAkG,EAAAY,QAAA,MAAAC,MAAAR,EACAL,EAAAW,WAAA,SACAX,EAAAY,QAAA,MAAA9G,MAAA,KAAA+C,MAAA,GAAA/D,OACAkH,EAAAY,QAAA,MAAAC,MAAAR,EAUAL,EAAAY,QAAA,MAAA9G,MAAA,MACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,kBACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,aACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,cACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,aACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,cACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,kBACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,WACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,aACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,YACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAA9G,MAAA,gBACAkG,EAAAY,QAAA,MAAAH,UAAA,CAAAK,UAAA,GACAd,EAAAY,QAAA,MAAAG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEAlB,EAAAY,QAAA,MAAAG,OAAA,CAEAI,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAEA,QAAA3C,EAAA,EAAAA,EAAA2B,EAAAtF,OAAA2D,IAAA,CACA,MAAA+C,EAAAC,OAAAC,OAAAtB,EAAA3B,IACA5D,EAAA8G,KAAAH,GAIA3G,EAAA+G,QAAAC,IACA,MAAAC,EAAA5B,EAAA6B,OAAAF,GACAA,EAAAD,QAAA,CAAAI,EAAAxH,KACAsH,EAAAhB,QAAAtG,EAAA,GAAAyG,OAAA,CACAC,IAAA,CAAAH,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAC,KAAA,CAAAN,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAE,OAAA,CAAAP,MAAA,OAAAI,MAAA,CAAAC,KAAA,aACAG,MAAA,CAAAR,MAAA,OAAAI,MAAA,CAAAC,KAAA,cAGAU,EAAAhB,QAAAtG,EAAA,GAAAmG,UAAA,CAAAK,UAAA,OAIA,MAAAiB,QAAAlC,EAAAmC,KAAAC,cAGAC,EAAAC,IAAAC,gBAAA,IAAAC,KAAA,CAAAN,GAAA,CAAAO,KAAA,uEACAC,EAAA7C,SAAA8C,cAAA,KACAD,EAAAE,KAAAP,EACAK,EAAAG,SAAA,4BAAA7F,MAAA,GAAA/D,OAAA,SAAAuE,QAAAH,OAAA,QACAqF,EAAA1B,MAAA8B,QAAA,OACAjD,SAAAkD,KAAAC,YAAAN,GACAA,EAAAO,QACApD,SAAAkD,KAAAG,YAAAR,IAEAnC,cAAAzF,GACA,OAAAA,EAAAqI,IAAAC,IAEA,wBAAAC,EAAA,mBAAAC,EAAA,MAAAC,EAAA,MAAA7F,EAAA,OAAAzE,EAAA,YAAAuK,EAAA,aAAAhI,EAAA,gBAAAiI,EAAA,GAAAC,EAAA,eAAAxE,EAAA,YAAAyE,EAAA,aAAAC,EAAA,SAAAC,EAAA,SAAAC,EAAA,UAAAC,EAAA,YAAAC,EAAA,eAAAC,EAAA,QAAAC,EAAA,aAAAC,EAAA,SAAAC,EAAA,KAAAC,EAAA,YAAAC,EAAA,SAAAC,EAAA,QAAAC,KAAAC,GAAArB,EACA,OAAAqB,KAGAnE,gBAAAxF,GACA,MAAA4J,EAAA,0HACAC,EAAA7J,EAAAqI,IAAA3I,GAAAkH,OAAAkD,OAAA,MAAAF,EAAAvB,IAAAzI,IAAA,EAAAA,GAAAF,EAAAE,QAEA,OADA4D,QAAAC,IAAAoG,GACAA,KCphBmV,I,YCO/UE,EAAY,eACd,EACAzL,EACA+C,GACA,EACA,KACA,KACA,MAIa,aAAA0I,E","file":"js/chunk-2d772d54.49a8aef2.js","sourcesContent":["import http from \"../config\"\r\nconst URL_TKB = \"TKB_HocKy\";\r\nconst URL_DotHK = \"TKB_Dot\";\r\nconst URL_DSSV = \"TKB_DS_Sinhvien\";\r\nconst URL_LichThi = \"TKB_LichThi\";\r\nconst URL_LichDay = \"TKB_GiangDay\";\r\nconst URL_Nganh = \"Nganh\";\r\nclass TKBHocKyService{\r\n    getTKBHocKy(params){\r\n        return http.get(URL_TKB,{\r\n            params:params\r\n        })\r\n    }\r\n    getTKBLichThi(params){\r\n        return http.get(URL_LichThi,{\r\n            params:params\r\n        })\r\n    }\r\n    getDotHocKy(){\r\n        return http.get(URL_DotHK)\r\n    }\r\n    getdssv(MaLopHocPhan,MaLopHoc,TenDot){\r\n        return http.get(URL_DSSV+\"/\"+MaLopHocPhan+\"/\"+MaLopHoc+\"/\"+TenDot)\r\n    }\r\n    getTKBGiangDay(params){\r\n        return http.get(URL_LichDay,{\r\n            params:params\r\n        })\r\n    }\r\n    getNganh(){\r\n        return http.get(URL_Nganh)\r\n    }\r\n}\r\nexport default new TKBHocKyService()","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-card',[_c('a-row',{attrs:{\"type\":\"flex\",\"align\":\"middle\"}},[_c('img',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":\"/../images/banner.png\",\"alt\":\"Banner\"}})]),_c('div',[_c('a-form',{staticClass:\"product__search-form\",on:{\"submit\":_vm.handleSearch}},[_c('a-row',[_c('a-col',{staticStyle:{\"padding-right\":\"20px\"},attrs:{\"span\":14}},[_c('a-form-item',[_c('a-input-search',{attrs:{\"placeholder\":\"Mã môn/Tên môn\"},model:{value:(_vm.params.search),callback:function ($$v) {_vm.$set(_vm.params, \"search\", $$v)},expression:\"params.search\"}},[_c('a-icon',{attrs:{\"type\":\"search\"}})],1)],1)],1),_c('a-col',{attrs:{\"span\":10}},[_c('a-form-item',[_c('a-select',{attrs:{\"placeholder\":_vm.datahk[0].TenDot},model:{value:(_vm.params.hocky),callback:function ($$v) {_vm.$set(_vm.params, \"hocky\", $$v)},expression:\"params.hocky\"}},_vm._l((_vm.datahk),function(item,index){return _c('a-select-option',{key:index,attrs:{\"value\":item.TenDot}},[_vm._v(_vm._s(item.TenDot))])}),1)],1)],1)],1)],1),_c('a-button',{attrs:{\"type\":\"primary\",\"html-type\":\"submit\"},on:{\"click\":_vm.handleSearch}},[_vm._v(\" Search \")]),_c('a-button',{staticStyle:{\"margin-left\":\"20px\"},attrs:{\"type\":\"primary\",\"html-type\":\"submit\"},on:{\"click\":_vm.resetButton}},[_vm._v(\" Reset \")]),(_vm.data.length>0)?_c('button',{staticClass:\"download-btn\",staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"button\"},on:{\"click\":_vm.exportToExcel}},[_c('a-icon',{attrs:{\"type\":\"file-excel\",\"theme\":\"filled\"}})],1):_vm._e()],1),_c('a-table',{attrs:{\"columns\":_vm.columns,\"data-source\":_vm.data,\"pagination\":false},scopedSlots:_vm._u([{key:\"DaKhoaDiemQuaTrinh\",fn:function(text){return [(text)?_c('div',{staticClass:\"author-info\"},[_c('p',{staticClass:\"m-0 font-regular\",staticStyle:{\"color\":\"green\"}},[_vm._v(\"Đã khóa\")])]):_c('div',{staticClass:\"author-info\"},[_c('p',{staticClass:\"m-0 font-regular\",staticStyle:{\"color\":\"dodgerblue\"}},[_vm._v(\"Chưa khóa\")])])]}},{key:\"DaKhoaDiemKetThuc\",fn:function(text){return [(text)?_c('div',{staticClass:\"author-info\"},[_c('p',{staticClass:\"m-0 font-regular\",staticStyle:{\"color\":\"green\"}},[_vm._v(\"Đã khóa\")])]):_c('div',{staticClass:\"author-info\"},[_c('p',{staticClass:\"m-0 font-regular\",staticStyle:{\"color\":\"dodgerblue\"}},[_vm._v(\"Chưa khóa\")])])]}},{key:\"IsDaNopBanGiay\",fn:function(text,record){return [(text==1)?_c('div',{staticClass:\"author-info\"},[_c('p',{staticClass:\"m-0 font-regular\",staticStyle:{\"color\":\"green\"}},[_vm._v(\"Đã nộp\")])]):_c('div',{staticClass:\"author-info\",staticStyle:{\"white-space\":\"nowrap\"}},[_c('input',{attrs:{\"type\":\"checkbox\",\"id\":'uncheckedbox_' + record.IDLopHocPhan},on:{\"change\":function($event){return _vm.updateStatus(record.IDLopHocPhan,1)}}})])]}},{key:\"NgayThi\",fn:function(text){return [_c('div',{staticClass:\"author-info\"},[_c('p',{staticClass:\"m-0 font-regular\"},[_vm._v(_vm._s(text.split('T')[0].split('-')[2]+\"-\"+text.split('T')[0].split('-')[1]+\"-\"+text.split('T')[0].split('-')[0]))])])]}},{key:\"NgayNopBanGiay\",fn:function(text){return [_c('div',{staticClass:\"author-info\"},[_c('p',{staticClass:\"m-0 font-regular\"},[_vm._v(_vm._s(text.split('T')[0].split('-')[2]+\"-\"+text.split('T')[0].split('-')[1]+\"-\"+text.split('T')[0].split('-')[0]))])])]}},{key:\"editBtn\",fn:function(text){return [_c('div',[_c('a',{staticClass:\"button\",attrs:{\"href\":'/DSSV_LHP_SiSo/'+ text.MaMonHoc+'/'+text.LopDuKien+'/'+text.TenDot}},[_c('a-icon',{staticStyle:{\"font-size\":\"25px\",\"color\":\"#007bff\"},attrs:{\"type\":\"info-circle\"}})],1)])]}}])}),_c('div',{staticStyle:{\"padding-top\":\"15px\",\"padding-left\":\"15px\"}},[_c('a-pagination',{attrs:{\"current\":this.params.page,\"default-current\":this.params.limit,\"total\":this.totalRecords,\"show-size-changer\":\"\"},on:{\"showSizeChange\":_vm.onShowSizeChange,\"change\":_vm.onChange}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import http from \"../config\"\r\nconst URL_GetAll = \"QLDHP\";\r\nconst URL_GetDS =\"QLDHP\";\r\nclass QuanLyDiemHPService{\r\n    getAll(params){\r\n        return http.get(URL_GetAll,{\r\n            params:params\r\n        })\r\n    }\r\n    Update(IDLopHocPhan,status){\r\n        return http.put(URL_GetAll+\"/\"+IDLopHocPhan+\"/\"+status)\r\n    }\r\n    getDS(params){\r\n        return http.get(URL_GetDS,{\r\n            params:params\r\n        })\r\n    }\r\n}\r\nexport default new QuanLyDiemHPService()","<template style=\"font-family: Tahoma\">\r\n  <div>\r\n    <!-- Authors Table Card -->\r\n    <a-card>\r\n      <a-row type=\"flex\" align=\"middle\">\r\n        <img style=\"width: 100%\" src=\"/../images/banner.png\" alt=\"Banner\"/>\r\n      </a-row>\r\n      <div>\r\n        <a-form @submit=\"handleSearch\" class=\"product__search-form\">\r\n          <a-row>\r\n            <a-col :span=\"14\" style=\"padding-right: 20px\">\r\n              <a-form-item >\r\n                <a-input-search  v-model=\"params.search\" placeholder=\"Mã môn/Tên môn\">\r\n                  <a-icon type=\"search\"/>\r\n                </a-input-search>\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :span=\"10\">\r\n              <a-form-item>\r\n                <a-select v-model=\"params.hocky\"  :placeholder=\"datahk[0].TenDot\">\r\n                  <a-select-option v-for=\"(item, index) in datahk\" :value=\"item.TenDot\" :key=\"index\">{{ item.TenDot }}</a-select-option>\r\n                </a-select>\r\n              </a-form-item>\r\n            </a-col>\r\n          </a-row>\r\n        </a-form>\r\n        <a-button type=\"primary\" @click=\"handleSearch\" html-type=\"submit\">\r\n          Search\r\n        </a-button>\r\n        <a-button type=\"primary\" html-type=\"submit\" @click=\"resetButton\"  style=\"margin-left: 20px\">\r\n          Reset\r\n        </a-button>\r\n        <button v-if=\"data.length>0\" type=\"button\" class=\"download-btn\" style=\"float: right\" v-on:click=\"exportToExcel\">\r\n          <a-icon type=\"file-excel\" theme=\"filled\"/>\r\n        </button>\r\n      </div>\r\n      <a-table :columns=\"columns\" :data-source=\"data\" :pagination=\"false\">\r\n<!--        <template slot=\"TrangThaiDangKy\" slot-scope=\"text\">-->\r\n<!--          <div class=\"author-info\"  v-if=\"text=='Đăng ký mới'\">-->\r\n<!--            <p class=\"m-0 font-regular\" style=\"color: green\" >{{ text }}</p>-->\r\n<!--          </div>-->\r\n<!--          <div class=\"author-info\"  v-else-if=\"text=='Đăng ký học lại'\">-->\r\n<!--            <p class=\"m-0 font-regular\" style=\"color: dodgerblue\">{{ text }}</p>-->\r\n<!--          </div>-->\r\n<!--          <div class=\"author-info\"  v-else>-->\r\n<!--            <p class=\"m-0 font-regular\" style=\"color: red\">{{ text }}</p>-->\r\n<!--          </div>-->\r\n<!--        </template>-->\r\n        <template slot=\"DaKhoaDiemQuaTrinh\" slot-scope=\"text\">\r\n          <div class=\"author-info\" v-if=\"text\">\r\n            <p class=\"m-0 font-regular\" style=\"color: green\" >Đã khóa</p>\r\n          </div>\r\n          <div class=\"author-info\" v-else>\r\n            <p class=\"m-0 font-regular\" style=\"color: dodgerblue\" >Chưa khóa</p>\r\n          </div>\r\n        </template>\r\n        <template slot=\"DaKhoaDiemKetThuc\" slot-scope=\"text\">\r\n          <div class=\"author-info\" v-if=\"text\">\r\n            <p class=\"m-0 font-regular\" style=\"color: green\" >Đã khóa</p>\r\n          </div>\r\n          <div class=\"author-info\" v-else>\r\n            <p class=\"m-0 font-regular\" style=\"color: dodgerblue\" >Chưa khóa</p>\r\n          </div>\r\n        </template>\r\n        <template slot=\"IsDaNopBanGiay\" slot-scope=\"text,record\">\r\n          <div class=\"author-info\" v-if=\"text==1\">\r\n            <p class=\"m-0 font-regular\" style=\"color: green\" >Đã nộp</p>\r\n          </div>\r\n          <div class=\"author-info\" v-else style=\"white-space: nowrap\">\r\n            <input type=\"checkbox\"  :id=\"'uncheckedbox_' + record.IDLopHocPhan\"  @change=\"updateStatus(record.IDLopHocPhan,1)\"/>\r\n          </div>\r\n\r\n        </template>\r\n        <template slot=\"NgayThi\" slot-scope=\"text\">\r\n          <div class=\"author-info\"  >\r\n            <p class=\"m-0 font-regular\"  >{{ text.split('T')[0].split('-')[2]+\"-\"+text.split('T')[0].split('-')[1]+\"-\"+text.split('T')[0].split('-')[0] }}</p>\r\n          </div>\r\n        </template>\r\n        <template slot=\"NgayNopBanGiay\" slot-scope=\"text\">\r\n          <div class=\"author-info\"  >\r\n            <p class=\"m-0 font-regular\"  >{{ text.split('T')[0].split('-')[2]+\"-\"+text.split('T')[0].split('-')[1]+\"-\"+text.split('T')[0].split('-')[0] }}</p>\r\n          </div>\r\n        </template>\r\n        <template slot=\"editBtn\" slot-scope=\"text\">\r\n          <div>\r\n            <a class=\"button\" :href=\"'/DSSV_LHP_SiSo/'+ text.MaMonHoc+'/'+text.LopDuKien+'/'+text.TenDot \">\r\n              <a-icon style=\"font-size: 25px;color: #007bff\" type=\"info-circle\"/>\r\n            </a>\r\n          </div>\r\n        </template>\r\n      </a-table>\r\n      <div style=\"padding-top: 15px;padding-left: 15px\">\r\n        <a-pagination\r\n            :current=\"this.params.page\"\r\n            :default-current=\"this.params.limit\"\r\n            :total=\"this.totalRecords\"\r\n            show-size-changer\r\n            @showSizeChange=\"onShowSizeChange\"\r\n            @change=\"onChange\"\r\n        />\r\n      </div>\r\n    </a-card>\r\n    <!-- / Authors Table Card -->\r\n  </div>\r\n</template>\r\n<script>\r\nimport QuanLyDiemHPService from \"@/service/QuanLyDiemHPService\";\r\nimport TKBHocKyService from \"@/service/TKBHocKyService\";\r\nimport ExcelJS from \"exceljs\";\r\nconst columns = [\r\n  {\r\n    title: 'Mã môn học',\r\n    dataIndex: 'MaMonHoc',\r\n    scopedSlots: { customRender: 'MaMonHoc' },\r\n  },\r\n  {\r\n    title: 'Tên môn học',\r\n    dataIndex: 'TenMonHoc',\r\n    scopedSlots: { customRender: 'TenMonHoc' },\r\n  },\r\n  {\r\n    title: 'STC',\r\n    dataIndex: 'SoTinChi',\r\n    scopedSlots: { customRender: 'SoTinChi' },\r\n  },\r\n  {\r\n    title: 'Lớp Học Phần',\r\n    dataIndex: 'MaLopHoc',\r\n    scopedSlots: { customRender: 'MaLopHoc' },\r\n  },\r\n  {\r\n    title: 'Giảng viên',\r\n    dataIndex: 'TenGiangVien',\r\n    scopedSlots: { customRender: 'TenGiangVien' },\r\n  },\r\n  {\r\n    title: 'Ngày thi',\r\n    dataIndex: 'NgayThi',\r\n    scopedSlots: { customRender: 'NgayThi' },\r\n  },\r\n  {\r\n    title: 'Khóa DQT',\r\n    dataIndex: 'DaKhoaDiemQuaTrinh',\r\n    scopedSlots: { customRender: 'DaKhoaDiemQuaTrinh' },\r\n  },\r\n  {\r\n    title: 'Khóa điểm KT',\r\n    dataIndex: 'DaKhoaDiemKetThuc',\r\n    scopedSlots: { customRender: 'DaKhoaDiemKetThuc' },\r\n  },\r\n  {\r\n    title: 'Đã nộp bản giấy',\r\n    dataIndex: 'IsDaNopBanGiay',\r\n    scopedSlots: { customRender: 'IsDaNopBanGiay' },\r\n  },\r\n  {\r\n    title: 'Ngày nộp bản giấy',\r\n    dataIndex: 'NgayNopBanGiay',\r\n    scopedSlots: { customRender: 'NgayNopBanGiay' },\r\n  },\r\n];\r\n//Trong Vue.js, a-table hoặc các thành phần tương tự sẽ ưu tiên sử dụng dữ liệu từ data() nếu có. Nếu data() không chứa dữ liệu cụ thể, thì nó sẽ thử tìm dữ liệu từ props.\r\n// \"Authors\" table list of rows and their properties.\r\nconst table1Data = [\r\n];\r\nexport default ({\r\n  data() {\r\n    return {\r\n      // Active button for the \"Authors\" table's card header radio button group.\r\n      authorsHeaderBtns: 'all',\r\n      data:[],\r\n      data1:[],\r\n      columns:columns,\r\n      totalRecords: undefined,\r\n      totalPages:undefined,\r\n      TenPhong:undefined,\r\n      new_data:[],\r\n      params:{\r\n        page:1,\r\n        limit:10,\r\n        search:undefined,\r\n        hocky:undefined,\r\n        orderby:\"MaMonHoc\"\r\n      },\r\n      params1:{\r\n        page:1,\r\n        limit:10000000,\r\n        search:undefined,\r\n        hocky:undefined,\r\n        orderby:\"MaMonHoc\"\r\n      },\r\n      isChecked: false,\r\n      IDDot:undefined,\r\n      datahk:[]\r\n    }\r\n  },\r\n  created(){\r\n    localStorage.setItem('link',this.$route.fullPath);\r\n    this.getTKBDotHK()\r\n  },\r\n  methods:{\r\n    async getTKBDotHK(){\r\n      await  TKBHocKyService.getDotHocKy().then(\r\n          rs=>{\r\n            try{\r\n              this.datahk = rs.data.result.recordset;\r\n              console.log(this.datahk)\r\n            }catch (e){\r\n              console.log(e);\r\n              console.log(\"Có lỗi ở đợt học kỳ\");\r\n            }\r\n          }\r\n      )\r\n    },\r\n    async getQuanLyDHP(){\r\n      await QuanLyDiemHPService.getAll(this.params).then(\r\n          rs=>{\r\n            try{\r\n              this.data=[]\r\n              console.log(rs)\r\n              if(rs.data.records != undefined) {\r\n                this.data = rs.data.records\r\n                for (let i=0;i<this.data.length;i++){\r\n                  this.data[i]['checked']=false\r\n                  this.data[i]['STT'] = i+1;\r\n                }\r\n              }else {\r\n                this.data=[]\r\n              }\r\n              console.log(this.data)\r\n              if(rs.data.filtered>0) {\r\n                this.totalRecords = rs.data.filtered;\r\n              }else {\r\n                this.totalRecords=0\r\n              }\r\n              console.log(this.data)\r\n            }catch (e){\r\n              console.log(e)\r\n              console.log(\"Có lỗi\")\r\n              this.totalRecords=0\r\n            }\r\n          }\r\n      )\r\n    },\r\n    onShowSizeChange(current, pageSize) {\r\n      this.params.limit = pageSize;\r\n      this.params.page = current;\r\n      this.getQuanLyDHP();\r\n    },\r\n    onChange(page, pageSize) {\r\n      this.params.page = page;\r\n      this.params.limit = pageSize;\r\n      this.getQuanLyDHP();\r\n    },\r\n    handleSearch(e){\r\n      e.preventDefault();\r\n      this.params.page = 1;\r\n      if (this.params.hocky ==undefined){\r\n        console.log(this.datahk[0].TenDot)\r\n        this.params.hocky = this.datahk[0].TenDot\r\n        console.log(this.params.hocky)\r\n      }\r\n      this.getQuanLyDHP();\r\n      this.GetQuanLyDHP1();\r\n      console.log(this.params);\r\n\r\n    },\r\n    async GetQuanLyDHP1(){\r\n      this.params1.search= this.params.search\r\n      this.params1.hocky=this.params.hocky\r\n      await QuanLyDiemHPService.getAll(this.params1).then(\r\n          rs=>{\r\n            try{\r\n              this.data1=[]\r\n              console.log(rs)\r\n              if(rs.data.records != undefined) {\r\n                this.data1 = rs.data.records.filter(item =>\r\n                    item.IsDaNopBanGiay === null ||\r\n                    item.IsDaNopBanGiay === false ||\r\n                    item.IsDaNopBanGiay === 0\r\n                );\r\n                for (let i=0;i<this.data1.length;i++){\r\n                  this.data1[i]['STT'] = i+1;\r\n                  const text= this.data1[i]['NgayThi']\r\n                  this.data1[i]['NgayThi']=text.split('T')[0].split('-')[2]+\"-\"+text.split('T')[0].split('-')[1]+\"-\"+text.split('T')[0].split('-')[0]\r\n                  const MGV = Array.from(new Set(this.data1[i]['MaGiangVien'].split(', ')))\r\n                  const TGV =Array.from(new Set(this.data1[i]['TenGiangVien'].split(', ')))\r\n                  console.log(MGV)\r\n                  console.log(TGV)\r\n                  this.data1[i]['GiangVien']=\"\"\r\n                  for ( let j=0;j<MGV.length;j++){\r\n                    this.data1[i]['GiangVien']+=MGV[j]+\"-\"+TGV[j]\r\n                    if( j!=MGV.length-1){\r\n                      this.data1[i]['GiangVien'] += \", \"\r\n                    }\r\n                  }\r\n                }\r\n              }else {\r\n                this.data1=[]\r\n              }\r\n              console.log(this.data1)\r\n            }catch (e){\r\n              console.log(e)\r\n              console.log(\"Có lỗi\")\r\n            }\r\n          }\r\n      )\r\n    },\r\n    updateStatus(idlophocphan,status){\r\n\r\n      if(status==1) {\r\n        console.log(idlophocphan)\r\n        this.$confirm({\r\n          title: 'Xác nhận đã nộp bản giấy',\r\n          onOk: () => {\r\n            QuanLyDiemHPService.Update(idlophocphan,'1').then(\r\n                rs => {\r\n                  for (let i=0;i<this.data.length;i++){\r\n                    if(this.data[i]['IDLopHocPhan'] == idlophocphan){\r\n                      this.data[i]['checked']=true\r\n                    }\r\n                  }\r\n                  console.log(rs.data)\r\n                  this.getQuanLyDHP()\r\n                  this.GetQuanLyDHP1();\r\n                }\r\n            )\r\n          },\r\n          onCancel: () => {\r\n\r\n            QuanLyDiemHPService.Update(idlophocphan,'0').then(\r\n                rs => {\r\n                  console.log(rs.data)\r\n                  document.getElementById(\"uncheckedbox_\"+idlophocphan).checked = false;\r\n                  for (let i=0;i<this.data.length;i++){\r\n                    if(this.data[i]['IDLopHocPhan'] == idlophocphan){\r\n                      this.data[i]['checked']=false\r\n                      console.log(this.data[i]['checked'])\r\n                    }\r\n                  }\r\n                  this.isChecked=false\r\n\r\n                  this.getQuanLyDHP()\r\n                  this.GetQuanLyDHP1();\r\n                }\r\n            )\r\n          }\r\n        })\r\n      }\r\n    },\r\n    resetButton(){\r\n      this.params = {\r\n        page:1,\r\n        limit:10,\r\n        search:\"\",\r\n        hocky:this.datahk[0].TenDot,\r\n        orderby:\"MaMonHoc\"\r\n      }\r\n      this.getQuanLyDHP();\r\n      this.GetQuanLyDHP1();\r\n    },\r\n    async exportToExcel() {\r\n      const workbook = new ExcelJS.Workbook();\r\n      const worksheet = workbook.addWorksheet(\"Danh sách lớp học phần chưa nộp điểm\");\r\n      const studentData=this.OrderProperties(this.customizeData(this.data1))\r\n      console.log(studentData)\r\n      // Tạo các dòng dữ liệu\r\n      const data = [];\r\n\r\n      // Create a cell style for the title\r\n      const titleStyle = {\r\n        font: {\r\n          size: 16,\r\n          bold: true,\r\n        },\r\n        alignment: {\r\n          horizontal: 'center',\r\n        },\r\n      };\r\n\r\n\r\n      // Merge cells for the title\r\n      worksheet.mergeCells('A1:K1');\r\n      worksheet.getCell('A1').value = \"Danh sách lớp học phần chưa nộp điểm\";\r\n      worksheet.getCell('A1').style = titleStyle;\r\n      worksheet.mergeCells('A2:K2');\r\n      worksheet.getCell('A2').value = this.data1[0].TenDot;\r\n      worksheet.getCell('A2').style = titleStyle;\r\n      // Set data values for the information cells\r\n      // Apply the border style to hide gridlines in the range A1 to H4\r\n      // const shadingStyle = {\r\n      //   type: 'pattern',\r\n      //   pattern: 'solid',\r\n      //   fgColor: { argb: 'FFFFFFFF' }, // Adjust the color as needed\r\n      // };\r\n      // Apply the shading style to the range A1 to H4\r\n      // Add the title for the student data\r\n      worksheet.getCell('A4').value = \"STT\";\r\n      worksheet.getCell('A4').alignment ={wrapText:true}\r\n      worksheet.getCell('A4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('B4').value = \"Mã lớp học phần\";\r\n      worksheet.getCell('B4').alignment ={wrapText:true}\r\n      worksheet.getCell('B4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('C4').value = \"Mã môn học\";\r\n      worksheet.getCell('C4').alignment ={wrapText:true}\r\n      worksheet.getCell('C4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('D4').value = \"Tên môn học\";\r\n      worksheet.getCell('D4').alignment ={wrapText:true}\r\n      worksheet.getCell('D4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('E4').value = \"Số tín chỉ\";\r\n      worksheet.getCell('E4').alignment ={wrapText:true}\r\n      worksheet.getCell('E4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('F4').value = \"Lớp môn học\";\r\n      worksheet.getCell('F4').alignment ={wrapText:true}\r\n      worksheet.getCell('F4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('G4').value = \"Sĩ số sinh viên\";\r\n      worksheet.getCell('G4').alignment ={wrapText:true}\r\n      worksheet.getCell('G4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('H4').value = \"Ngày thi\";\r\n      worksheet.getCell('H4').alignment ={wrapText:true}\r\n      worksheet.getCell('H4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('I4').value = \"Giảng viên\";\r\n      worksheet.getCell('I4').alignment ={wrapText:true}\r\n      worksheet.getCell('I4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('J4').value = \"Tổ bộ môn\";\r\n      worksheet.getCell('J4').alignment ={wrapText:true}\r\n      worksheet.getCell('J4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('K4').value = \"Khoa chủ quản\";\r\n      worksheet.getCell('K4').alignment ={wrapText:true}\r\n      worksheet.getCell('K4').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('L4').border = {\r\n\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      for (let i=0;i<studentData.length;i++){\r\n        const studentArray = Object.values(studentData[i])\r\n        data.push(studentArray)\r\n      }\r\n\r\n      // Add the data to the worksheet\r\n      data.forEach((row) => {\r\n        const excelRow = worksheet.addRow(row);\r\n        row.forEach((column, index) => {\r\n          excelRow.getCell(index + 1).border = {\r\n            top: { style: 'thin', color: { argb: '00000000' } },\r\n            left: { style: 'thin', color: { argb: '00000000' } },\r\n            bottom: { style: 'thin', color: { argb: '00000000' } },\r\n            right: { style: 'thin', color: { argb: '00000000' } },\r\n          };\r\n\r\n          excelRow.getCell(index+1).alignment={wrapText:true}\r\n        });\r\n      });\r\n\r\n      const blob = await workbook.xlsx.writeBuffer();\r\n\r\n      // Create a Blob URL and trigger a download\r\n      const blobURL = URL.createObjectURL(new Blob([blob], { type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" }));\r\n      const a = document.createElement(\"a\");\r\n      a.href = blobURL;\r\n      a.download = \"DanhSachChuaNopDiem_\" +this.data1[0].TenDot+\"_\"+this.params1.search+\".xlsx\";\r\n      a.style.display = \"none\";\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n    },\r\n    customizeData(data){\r\n      return data.map((dssv)=>{\r\n        // eslint-disable-next-line no-unused-vars\r\n        const{DaKhoaDiemKetThuc,DaKhoaDiemQuaTrinh,Email,IDDot,TenDot,TenHeDaoTao,IDLopHocPhan,IDLopXepLichThi,Id,IsDaNopBanGiay,MaGiangVien,TenGiangVien,IsKhoaTH,IsKhoaTL,IsXacNhan,NgayCapNhat,NgayNopBanGiay,NgayTao,NguoiCapNhat,NguoiTao,Nhom,SoDienThoai,TenNganh,TenNghe,...rest} = dssv;\r\n        return rest\r\n      });\r\n    },\r\n    OrderProperties(data){\r\n      const newOrder = [\"STT\", \"MaLopHocPhan\", \"MaMonHoc\", \"TenMonHoc\", \"SoTinChi\", \"MaLopHoc\", \"SiSo\", \"NgayThi\",\"GiangVien\",\"TenBoMon\",\"TenPhongBan\"];\r\n      const newData = data.map((item) => Object.assign({}, ...newOrder.map((key) => ({ [key]: item[key] }))))\r\n      console.log(newData)\r\n      return newData;\r\n    },\r\n  }\r\n})\r\n\r\n</script>\r\n\r\n\r\n<style lang=\"scss\">\r\n</style>\r\n\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuanLyDHP.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuanLyDHP.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QuanLyDHP.vue?vue&type=template&id=240eeca6&style=font-family%3A%20Tahoma&\"\nimport script from \"./QuanLyDHP.vue?vue&type=script&lang=js&\"\nexport * from \"./QuanLyDHP.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}