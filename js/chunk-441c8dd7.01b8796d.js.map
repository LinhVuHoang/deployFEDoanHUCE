{"version":3,"sources":["webpack:///./src/service/TKBHocKyService.js","webpack:///./src/views/DSSV.vue?a460","webpack:///src/views/DSSV.vue","webpack:///./src/views/DSSV.vue?9fb3","webpack:///./src/views/DSSV.vue","webpack:///./src/views/DSSV.vue?48b0"],"names":["URL_TKB","URL_DotHK","URL_DSSV","URL_LichThi","URL_LichDay","URL_Nganh","TKBHocKyService","getTKBHocKy","params","http","get","getTKBLichThi","getDotHocKy","getdssv","MaLopHocPhan","MaLopHoc","TenDot","getTKBGiangDay","getNganh","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","padding","staticStyle","_v","_s","data","TenMonHoc","SiSo","on","exportToExcel","_l","sv","STT","MaSinhVien","HoDem","Ten","Email","SoDienThoai","TenLop","NgaySinh2","staticRenderFns","totalRecords","undefined","totalPages","TenPhong","new_data","datahk","created","localStorage","setItem","$route","fullPath","getDSSV","methods","console","log","then","rs","result","recordset","i","length","e","workbook","ExcelJS","Workbook","worksheet","addWorksheet","studentData","OrderProperties","customizeData","titleStyle","font","size","bold","alignment","horizontal","border","left","style","color","argb","dataCellStyle","mergeCells","getCell","value","shadingStyle","type","pattern","fgColor","row","col","fill","wrapText","top","bottom","right","studentArray","Object","values","push","forEach","excelRow","addRow","column","index","blob","xlsx","writeBuffer","blobURL","URL","createObjectURL","Blob","a","document","createElement","href","download","display","body","appendChild","click","removeChild","map","dssv","IDLopHocDanhNghia","IDLopHocPhan","IDDot","IDLopHocphan","IDSinhVien","rest","newOrder","newData","item","assign","key","component"],"mappings":"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","file":"js/chunk-441c8dd7.01b8796d.js","sourcesContent":["import http from \"../config\"\r\nconst URL_TKB = \"TKB_HocKy\";\r\nconst URL_DotHK = \"TKB_Dot\";\r\nconst URL_DSSV = \"TKB_DS_Sinhvien\";\r\nconst URL_LichThi = \"TKB_LichThi\";\r\nconst URL_LichDay = \"TKB_GiangDay\";\r\nconst URL_Nganh = \"Nganh\";\r\nclass TKBHocKyService{\r\n    getTKBHocKy(params){\r\n        return http.get(URL_TKB,{\r\n            params:params\r\n        })\r\n    }\r\n    getTKBLichThi(params){\r\n        return http.get(URL_LichThi,{\r\n            params:params\r\n        })\r\n    }\r\n    getDotHocKy(){\r\n        return http.get(URL_DotHK)\r\n    }\r\n    getdssv(MaLopHocPhan,MaLopHoc,TenDot){\r\n        return http.get(URL_DSSV+\"/\"+MaLopHocPhan+\"/\"+MaLopHoc+\"/\"+TenDot)\r\n    }\r\n    getTKBGiangDay(params){\r\n        return http.get(URL_LichDay,{\r\n            params:params\r\n        })\r\n    }\r\n    getNganh(){\r\n        return http.get(URL_Nganh)\r\n    }\r\n}\r\nexport default new TKBHocKyService()","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-card',{staticClass:\"header-solid h-full\",attrs:{\"bordered\":false,\"bodyStyle\":{padding: 0,}}},[_c('div',[_c('a-row',{attrs:{\"type\":\"flex\",\"align\":\"middle\"}},[_c('img',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":\"/../images/banner.png\",\"alt\":\"Banner\"}})]),_c('div',{staticClass:\"col-md-12 container\",staticStyle:{\"margin-top\":\"50px\"}},[_c('label',[_vm._v(\"Lớp: \"+_vm._s(this.data[0].MaLopHoc))]),_c('br'),_c('label',[_vm._v(\"Môn: \"+_vm._s(this.data[0].TenMonHoc))]),_c('br'),_c('label',[_vm._v(\"Sĩ số: \"+_vm._s(this.data[0].SiSo))]),_c('button',{staticClass:\"download-btn\",staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"button\"},on:{\"click\":_vm.exportToExcel}},[_c('a-icon',{attrs:{\"type\":\"file-excel\",\"theme\":\"filled\"}})],1),_c('div',{staticClass:\"table-wrap\"},[_c('table',{staticClass:\"table table-bordered\",staticStyle:{\"--bs-table-bg\":\"#2a8ecd\",\"border-right\":\"#5c5d62\"}},[_c('thead',[_c('tr',[_c('th',{staticStyle:{\"color\":\"#f6fffa\"}},[_vm._v(\"STT\")]),_c('th',{staticStyle:{\"color\":\"#f6fffa\"}},[_vm._v(\"Mã Sinh Viên\")]),_c('th',{staticStyle:{\"color\":\"#f6fffa\"}},[_vm._v(\"Tên Sinh Viên\")]),_c('th',{staticStyle:{\"color\":\"#f6fffa\"}},[_vm._v(\"Email\")]),_c('th',{staticStyle:{\"color\":\"#f6fffa\"}},[_vm._v(\"Số điện thoại\")]),_c('th',{staticStyle:{\"color\":\"#f6fffa\"}},[_vm._v(\"Lớp Học\")]),_c('th',{staticStyle:{\"color\":\"#f6fffa\"}},[_vm._v(\"Ngày Sinh\")])])]),_c('tbody',[_vm._l((_vm.data),function(sv){return _c('tr',[_c('td',[_c('span',{staticStyle:{\"color\":\"#002a5c\"}},[_vm._v(_vm._s(sv.STT))])]),_c('td',[_c('span',{staticStyle:{\"color\":\"#002a5c\"}},[_vm._v(_vm._s(sv.MaSinhVien))])]),_c('td',[_c('span',{staticStyle:{\"color\":\"#002a5c\"}},[_vm._v(_vm._s(sv.HoDem)+\" \"+_vm._s(sv.Ten))])]),(sv.Email)?_c('td',[_c('span',{staticStyle:{\"color\":\"#002a5c\"}},[_vm._v(_vm._s(sv.Email))])]):_c('td'),(sv.SoDienThoai)?_c('td',[_c('span',{staticStyle:{\"color\":\"#002a5c\"}},[_vm._v(_vm._s(sv.SoDienThoai))])]):_c('td'),_c('td',[_c('span',{staticStyle:{\"color\":\"#002a5c\"}},[_vm._v(_vm._s(sv.TenLop))])]),_c('td',[_c('span',{staticStyle:{\"color\":\"#002a5c\"}},[_vm._v(_vm._s(sv.NgaySinh2))])])])})],2)])])])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template style=\"font-family: Tahoma\">\r\n  <a-card :bordered=\"false\" class=\"header-solid h-full\" :bodyStyle=\"{padding: 0,}\">\r\n    <div>\r\n      <a-row type=\"flex\" align=\"middle\">\r\n        <img style=\"width: 100%\" src=\"/../images/banner.png\" alt=\"Banner\"/>\r\n      </a-row>\r\n    <div style=\"margin-top: 50px\" class=\"col-md-12 container\" >\r\n      <label>Lớp: {{this.data[0].MaLopHoc}}</label><br>\r\n      <label>Môn: {{this.data[0].TenMonHoc}}</label><br>\r\n      <label>Sĩ số: {{this.data[0].SiSo}}</label>\r\n      <button type=\"button\" class=\"download-btn\" style=\"float: right\" v-on:click=\"exportToExcel\">\r\n        <a-icon type=\"file-excel\" theme=\"filled\"/>\r\n      </button>\r\n      <div class=\"table-wrap\">\r\n        <table class=\"table table-bordered\" style=\"--bs-table-bg: #2a8ecd; border-right: #5c5d62\">\r\n          <thead>\r\n          <tr>\r\n            <th style=\"color: #f6fffa\">STT</th>\r\n            <th style=\"color: #f6fffa\">Mã Sinh Viên</th>\r\n            <th style=\"color: #f6fffa\">Tên Sinh Viên</th>\r\n            <th style=\"color: #f6fffa\">Email</th>\r\n            <th style=\"color: #f6fffa\">Số điện thoại</th>\r\n            <th style=\"color: #f6fffa\">Lớp Học</th>\r\n            <th style=\"color: #f6fffa\">Ngày Sinh</th>\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n          <template >\r\n              <tr v-for=\"(sv) in data\">\r\n                <td >\r\n                  <span style=\"color: #002a5c\">{{sv.STT}}</span>\r\n                </td>\r\n                <td >\r\n                  <span style=\"color: #002a5c\">{{sv.MaSinhVien}}</span>\r\n                </td>\r\n                <td >\r\n                  <span style=\"color: #002a5c\">{{sv.HoDem}} {{sv.Ten}}</span>\r\n                </td>\r\n                <td  v-if=\"sv.Email\">\r\n                  <span style=\"color: #002a5c\">{{sv.Email}}</span>\r\n                </td>\r\n                <td v-else></td>\r\n                <td  v-if=\"sv.SoDienThoai\">\r\n                  <span style=\"color: #002a5c\">{{sv.SoDienThoai}}</span>\r\n                </td>\r\n                <td v-else></td>\r\n                <td >\r\n                  <span style=\"color: #002a5c\">{{sv.TenLop}}</span>\r\n                </td>\r\n                <td >\r\n                  <span style=\"color: #002a5c\">{{sv.NgaySinh2}}</span>\r\n                </td>\r\n              </tr>\r\n          </template>\r\n          </tbody>\r\n        </table>\r\n\r\n<!--        <div style=\"padding-top: 15px\">-->\r\n<!--          <a-pagination-->\r\n<!--              :default-current=\"this.params.limit\"-->\r\n<!--              :total=\"this.totalRecords\"-->\r\n<!--              show-size-changer-->\r\n<!--              @showSizeChange=\"onShowSizeChange\"-->\r\n<!--              @change=\"onChange\"-->\r\n<!--          />-->\r\n<!--        </div>-->\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n  </a-card>\r\n</template>\r\n<script>\r\nimport TKBHocKyService from \"@/service/TKBHocKyService\";\r\n// import exportFromJSON from \"export-from-json\";\r\nimport ExcelJS from \"exceljs\";\r\nimport * as XLSX from 'xlsx'\r\nexport default {\r\n  data(){\r\n    return{\r\n      data:[],\r\n      totalRecords: undefined,\r\n      totalPages:undefined,\r\n      TenPhong:undefined,\r\n      new_data:[],\r\n      datahk:[],\r\n    }\r\n  },\r\n  created() {\r\n    localStorage.setItem('link',this.$route.fullPath);\r\n    this.getDSSV(this.$route.params.MaLopHocPhan,this.$route.params.MaLopHoc,this.$route.params.TenDot)\r\n\r\n  },\r\n  methods:{\r\n    async getDSSV(MaLopHocPhan,MaLopHoc,TenDot){\r\n      console.log(TenDot)\r\n      await TKBHocKyService.getdssv(MaLopHocPhan,MaLopHoc,TenDot).then(\r\n          rs=>{\r\n            try{\r\n              this.data=[]\r\n              console.log(rs)\r\n              this.data =  rs.data.result.recordset;\r\n              for (let i = 0; i < this.data.length; i++) {\r\n                this.data[i].STT = i + 1; // Bắt đầu index từ 1 hoặc 0 tùy theo tùy chọn của bạn\r\n              }\r\n              console.log(this.data)\r\n             // this.totalRecords = rs.data.filtered;\r\n            }catch (e){\r\n              console.log(e)\r\n              console.log(\"Có lỗi\")\r\n            }\r\n          }\r\n      )\r\n    },\r\n    // downloadFile() {\r\n    //   const data = this.investorsList;\r\n    //   const fileName = \"np-data\";\r\n    //   const exportType = exportFromJSON.types.xls;\r\n    //\r\n    //   if (data) exportFromJSON({ data, fileName, exportType });\r\n    // },\r\n//     download(){\r\n//       const data = XLSX.utils.json_to_sheet(this.OrderProperties(this.customizeData(this.data)))\r\n//       const wb = XLSX.utils.book_new()\r\n//       // Tạo nội dung tùy chỉnh\r\n//       XLSX.utils.book_append_sheet(wb, data, 'DanhSachSinhVien')\r\n//       // Tạo một dòng tiêu đề\r\n//     //  const headerRow = [\"Danh sách sinh vien\", \"Sĩ số\"];\r\n//\r\n// // Thêm dòng tiêu đề vào worksheet\r\n//       //XLSX.utils.sheet_add_aoa(this.data[0].SiSo, [headerRow], { origin: 'A1' });\r\n//       XLSX.writeFile(wb,'Danh_sach_sinh_vien_'+this.data[0].MaLopHoc+'.xlsx')\r\n//     },\r\n    async exportToExcel() {\r\n      const workbook = new ExcelJS.Workbook();\r\n      const worksheet = workbook.addWorksheet(\"Danh sách sinh viên\");\r\n      const studentData=this.OrderProperties(this.customizeData(this.data))\r\n      console.log(studentData)\r\n      // Tạo các dòng dữ liệu\r\n      const data = [];\r\n\r\n      // Create a cell style for the title\r\n      const titleStyle = {\r\n        font: {\r\n          size: 16,\r\n          bold: true,\r\n        },\r\n        alignment: {\r\n          horizontal: 'center',\r\n        },\r\n        border:{\r\n          left:{ style: 'thin', color: { argb: '00000000' } }\r\n        }\r\n      };\r\n\r\n      // Create a cell style for data\r\n      const dataCellStyle = {\r\n        font: {\r\n          size: 12,\r\n          bold: false, // Adjust as needed\r\n        },\r\n        alignment: {\r\n          horizontal: 'left',\r\n        },\r\n      };\r\n\r\n      // Merge cells for the title\r\n      worksheet.mergeCells('A1:I1');\r\n      worksheet.getCell('A1').value = \"DANH SÁCH SINH VIÊN LỚP HỌC PHẦN\";\r\n      worksheet.getCell('A1').style = titleStyle;\r\n\r\n      // Set data values for the information cells\r\n      worksheet.getCell('B2').value = \"Mã học phần: \"+this.data[0].MaLopHocPhan;\r\n      worksheet.getCell('F2').value = \"Học kỳ: \"+this.data[0].TenDot;;\r\n      worksheet.getCell('B3').value = \"Tên học phần: \" +this.data[0].TenMonHoc;;\r\n      worksheet.getCell('F3').value = \"Lớp học: \"+this.data[0].MaLopHoc;;\r\n      worksheet.getCell('B4').value = \"Sĩ số: \" +this.data[0].SiSo;\r\n\r\n      // Apply data cell style to information cells\r\n      worksheet.getCell('B2').style = dataCellStyle;\r\n      worksheet.getCell('F2').style = dataCellStyle;\r\n      worksheet.getCell('B3').style = dataCellStyle;\r\n      worksheet.getCell('F3').style = dataCellStyle;\r\n      worksheet.getCell('B4').style = dataCellStyle;\r\n      // Apply the border style to hide gridlines in the range A1 to H4\r\n      const shadingStyle = {\r\n        type: 'pattern',\r\n        pattern: 'solid',\r\n        fgColor: { argb: 'FFFFFFFF' }, // Adjust the color as needed\r\n      };\r\n\r\n      // Apply the shading style to the range A1 to H4\r\n      for (let row = 2; row <= 5; row++) {\r\n        for (let col = 1; col <= 8; col++) {\r\n          worksheet.getCell(row, col).fill = shadingStyle;\r\n        }\r\n      }\r\n      // Add the title for the student data\r\n      worksheet.getCell('A6').value = \"STT\";\r\n      worksheet.getCell('A6').alignment ={wrapText:true}\r\n      worksheet.getCell('A6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('B6').value = \"Mã sinh viên\";\r\n      worksheet.getCell('B6').alignment ={wrapText:true}\r\n      worksheet.getCell('B6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('C6').value = \"Họ Đệm\";\r\n      worksheet.getCell('C6').alignment ={wrapText:true}\r\n      worksheet.getCell('C6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('D6').value = \"Tên\";\r\n      worksheet.getCell('D6').alignment ={wrapText:true}\r\n      worksheet.getCell('D6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('E6').value = \"Email\";\r\n      worksheet.getCell('E6').alignment ={wrapText:true}\r\n      worksheet.getCell('E6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('F6').value = \"Số điện thoại\";\r\n      worksheet.getCell('F6').alignment ={wrapText:true}\r\n      worksheet.getCell('F6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('G6').value = \"Ngày Sinh\";\r\n      worksheet.getCell('G6').alignment ={wrapText:true}\r\n      worksheet.getCell('G6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      worksheet.getCell('H6').value = \"Lớp quản lý\";\r\n      worksheet.getCell('H6').alignment ={wrapText:true}\r\n      worksheet.getCell('H6').border = {\r\n        top: { style: 'thin', color: { argb: '00000000' } },\r\n        left: { style: 'thin', color: { argb: '00000000' } },\r\n        bottom: { style: 'thin', color: { argb: '00000000' } },\r\n        right: { style: 'thin', color: { argb: '00000000' } },\r\n      };\r\n      for (let i=0;i<studentData.length;i++){\r\n        const studentArray = Object.values(studentData[i])\r\n        data.push(studentArray)\r\n      }\r\n\r\n      // Add the data to the worksheet\r\n      data.forEach((row) => {\r\n        const excelRow = worksheet.addRow(row);\r\n        row.forEach((column, index) => {\r\n          excelRow.getCell(index + 1).border = {\r\n            top: { style: 'thin', color: { argb: '00000000' } },\r\n            left: { style: 'thin', color: { argb: '00000000' } },\r\n            bottom: { style: 'thin', color: { argb: '00000000' } },\r\n            right: { style: 'thin', color: { argb: '00000000' } },\r\n          };\r\n\r\n          excelRow.getCell(index+1).alignment={wrapText:true}\r\n        });\r\n      });\r\n      const blob = await workbook.xlsx.writeBuffer();\r\n\r\n      // Create a Blob URL and trigger a download\r\n      const blobURL = URL.createObjectURL(new Blob([blob], { type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" }));\r\n      const a = document.createElement(\"a\");\r\n      a.href = blobURL;\r\n      a.download = \"DanhSachSinhVien\" +this.data[0].MaLopHoc+\".xlsx\";\r\n      a.style.display = \"none\";\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n    },\r\n    customizeData(data){\r\n      return data.map((dssv)=>{\r\n        // eslint-disable-next-line no-unused-vars\r\n        const{IDLopHocDanhNghia,IDLopHocPhan,TenDot,IDDot,MaLopHocPhan,MaLopHoc,TenMonHoc,IDLopHocphan,IDSinhVien,SiSo,...rest} = dssv;\r\n        return rest\r\n      });\r\n    },\r\n    OrderProperties(data){\r\n      const newOrder = [\"STT\", \"MaSinhVien\", \"HoDem\", \"Ten\", \"Email\", \"SoDienThoai\", \"NgaySinh2\", \"TenLop\"];\r\n      const newData = data.map((item) => Object.assign({}, ...newOrder.map((key) => ({ [key]: item[key] }))))\r\n      console.log(newData)\r\n      return newData;\r\n    },\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n$color-primary: #4c4c4c;\r\n$color-secondary: #a6a6a6;\r\n$color-highlight: #ff3f40;\r\n.product__search-form{\r\n  display: grid;\r\n  gap: 2rem;\r\n  grid-template-columns: repeat(auto-fit,minmax(200px,1fr));\r\n}\r\n/* CSS để thêm border cho các cột */\r\n.table-bordered th {\r\n  border:1px solid black;\r\n\r\n}\r\n\r\n.table-bordered td {\r\n  border:1px solid black;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DSSV.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DSSV.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DSSV.vue?vue&type=template&id=97618878&scoped=true&style=font-family%3A%20Tahoma&\"\nimport script from \"./DSSV.vue?vue&type=script&lang=js&\"\nexport * from \"./DSSV.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DSSV.vue?vue&type=style&index=0&id=97618878&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"97618878\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DSSV.vue?vue&type=style&index=0&id=97618878&prod&lang=scss&scoped=true&\""],"sourceRoot":""}